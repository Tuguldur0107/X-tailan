## üìÑ X-SENDER Interaction Flow (ManyChat + Web App —Ö—É–≤–∏–ª–±–∞—Ä)

---

### ‚úÖ **Messenger Bot (ManyChat) ‚Äì –ó”©–≤—Ö”©–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω –∞–Ω—Ö–∞–Ω —à–∞—Ç–Ω—ã interaction**

| –£—Ä—Å–≥–∞–ª                       | “Æ–π–ª–¥—ç–ª                                | –¢–∞–π–ª–±–∞—Ä                                                                         |
| ---------------------------- | ------------------------------------- | ------------------------------------------------------------------------------- |
| 1. Start / Welcome           | Welcome Message + ‚Äú–≠—Ö–ª—ç—Ö‚Äù —Ç–æ–≤—á        | –¢–∞–Ω–∏–ª—Ü—É—É–ª–≥–∞ + action button                                                     |
| 2. Login                     | **Etax –Ω—ç—Ä, –Ω—É—É—Ü “Ø–≥** –∞—Å—É—É—Ö           | ManyChat `User Input` ‚Üí webhook ‚Üí backend `/messenger/login`                    |
| 3. –ö–æ–º–ø–∞–Ω–∏–π–Ω –±“Ø—Ä—Ç–≥—ç–ª         | + –∫–æ–º–ø–∞–Ω–∏ –Ω—ç–º—ç—Ö                       | `User Input` ‚Üí webhook `/messenger/add-company`                                 |
| 4. –¢–∞–π–ª–∞–Ω–≥–∏–π–Ω –º—ç–¥—ç—ç–ª—ç–ª —Ö–∞—Ä–∞—Ö | "–ú–∏–Ω–∏–π —Ç–∞–π–ª–∞–Ω" —Ç–æ–≤—á                   | webhook `/messenger/report-summary` ‚Üí "–¢–∞–Ω–¥ 2 —Ç–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –±–∞–π–Ω–∞" |
| 5. X —Ç–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö           | ‚Äú–ò–ª–≥—ç—ç—Ö‚Äù —Ç–æ–≤—á ‚Üí Web App —Ä—É—É —à–∏–ª–∂“Ø“Ø–ª–Ω—ç | Web App –ª–∏–Ω–∫: `https://xsender.mn/reports`                                      |
| 6. QPay —Ü—ç–Ω—ç–≥–ª—ç–ª—Ç            | ‚Äú–¶—ç–Ω—ç–≥–ª—ç—Ö‚Äù —Ç–æ–≤—á ‚Üí Web App             | Web App –ª–∏–Ω–∫: `https://xsender.mn/payment`                                      |

üìå **–ß—É—Ö–∞–ª:**
–¢–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö, —Å—Ç–∞—Ç—É—Å —à–∞–ª–≥–∞—Ö, —Ç“Ø“Ø—Ö —Ö–∞—Ä–∞—Ö –∑—ç—Ä—ç–≥ **–±“Ø—Ö –≥–æ–ª interaction –Ω—å Web App –¥—ç—ç—Ä —Ç”©–≤–ª”©—Ä–Ω”©**.

---

### üí¨ **ManyChat Flow Design**

#### ‚û§ Flow 1: Welcome Flow

* Greeting text: ‚Äú–°–∞–π–Ω –±–∞–π–Ω–∞ —É—É, X-SENDER –±–æ—Ç–æ–¥ —Ç–∞–≤—Ç–∞–π –º–æ—Ä–∏–ª!‚Äù
* Button 1: **‚Äú–ù—ç–≤—Ç—Ä—ç—Ö‚Äù**
* Button 2: **‚Äú–¶—ç–Ω—ç–≥–ª—ç—Ö‚Äù ‚Üí Open Website: `https://xsender.mn/payment`**

#### ‚û§ Flow 2: Login Flow

* Step 1: Ask **Etax –Ω—ç—Ä** (`User Input 1`)
* Step 2: Ask **Etax –Ω—É—É—Ü “Ø–≥** (`User Input 2`)
* Step 3: `External Request` ‚Üí POST `/api/messenger/login`
* Success ‚Üí ‚Äú–ê–º–∂–∏–ª—Ç—Ç–∞–π —Ö–∞–¥–≥–∞–ª–∞–≥–¥–ª–∞–∞‚Äù
* Error ‚Üí ‚ÄúEtax –Ω—ç—Ä —ç—Å–≤—ç–ª –Ω—É—É—Ü “Ø–≥ –±—É—Ä—É—É –±–∞–π–Ω–∞‚Äù

#### ‚û§ Flow 3: Add Company

* Ask: ‚Äú–ë“Ø—Ä—Ç–≥“Ø“Ø–ª—ç—Ö –∫–æ–º–ø–∞–Ω–∏–π–Ω –Ω—ç—Ä–∏–π–≥ –æ—Ä—É—É–ª–Ω–∞ —É—É‚Äù
* `External Request` ‚Üí POST `/api/messenger/add-company`

#### ‚û§ Flow 4: –¢–∞–π–ª–∞–Ω–≥–∏–π–Ω —Ç–æ–π–º

* Button: ‚Äú–ú–∏–Ω–∏–π —Ç–∞–π–ª–∞–Ω‚Äù
* `External Request` ‚Üí GET `/api/messenger/report-summary`
* Response: ‚Äú2025 –æ–Ω—ã 07-—Ä —Å–∞—Ä–¥ –• —Ç–∞–π–ª–∞–Ω, –ù”®–ê–¢ —Ç–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö —à–∞–∞—Ä–¥–ª–∞–≥–∞—Ç–∞–π –±–∞–π–Ω–∞.‚Äù

#### ‚û§ Flow 5: –ò–ª–≥—ç—ç—Ö

* Button: ‚Äú–¢–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö‚Äù ‚Üí Open Website ‚Üí `https://xsender.mn/reports`

---

### ‚öôÔ∏è Backend API (ManyChat Webhook Integration)

| Endpoint                        | Method | –¢–∞–π–ª–±–∞—Ä                                                  |
| ------------------------------- | ------ | -------------------------------------------------------- |
| `/api/messenger/login`          | POST   | Etax –Ω—ç—Ä/–Ω—É—É—Ü “Ø–≥ ‚Üí access\_token ‚Üí user table-–¥ —Ö–∞–¥–≥–∞–ª–∞—Ö |
| `/api/messenger/add-company`    | POST   | –ö–æ–º–ø–∞–Ω–∏–π–Ω –Ω—ç—Ä –±“Ø—Ä—Ç–≥—ç—Ö                                    |
| `/api/messenger/report-summary` | GET    | –¢—É—Ö–∞–π–Ω —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–Ω —Ç–∞–π–ª–∞–Ω–≥–∏–π–Ω —Ç–æ–æ/status text –±—É—Ü–∞–∞—Ö    |

---

### üíª Web App –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å ‚Äì ManyChat-–∞–∞—Å —á–∏–≥–ª“Ø“Ø–ª—ç—Ö —Ü–æ—Ä—ã–Ω –≥–∞–Ω—Ü 3 –ª–∏–Ω–∫:

| “Æ–π–ª–¥—ç–ª                | URL                          |
| --------------------- | ---------------------------- |
| –¢–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö         | `https://xsender.mn/reports` |
| –¢–∞–π–ª–∞–Ω–≥–∏–π–Ω —Ç“Ø“Ø—Ö —Ö–∞—Ä–∞—Ö | `https://xsender.mn/history` |
| QPay —Ü—ç–Ω—ç–≥–ª—ç–ª—Ç        | `https://xsender.mn/payment` |

---

### üß† –î–∞–≤—É—É —Ç–∞–ª

| ManyChat Bot              | Web App                                           |
| ------------------------- | ------------------------------------------------- |
| –≠–Ω–≥–∏–π–Ω, —Ö—É—Ä–¥–∞–Ω —ç—Ö–ª“Ø“Ø–ª–¥—ç–≥  | –ù–∏–π–ª–º—ç–ª –ª–æ–≥–∏–∫—Ç–∞–π UI                               |
| Login, —Å–∞–Ω—É—É–ª–≥–∞, push     | –¢–∞–π–ª–∞–Ω–≥–∏–π–Ω —Ç“Ø“Ø—Ö, —Ç”©–ª–±”©—Ä, –æ–ª–æ–Ω –∫–æ–º–ø–∞–Ω–∏–π–Ω –º–µ–Ω–µ–∂–º–µ–Ω—Ç |
| –ì—Ä–∞—Ñ–∏–∫–≥“Ø–π, —Ö—ç–ª–±—ç—Ä –±–∞–≥–∞—Ç–∞–π | –ë“Ø—Ö —Ç–∞–π–ª–∞–Ω –±“Ø—Ä—ç–Ω –∏–ª–≥—ç—ç–≥–¥–¥—ç–≥ –≥–∞–∑–∞—Ä                 |

---

## ‚úÖ –≠—Ü—Å–∏–π–Ω –∑–æ—Ä–∏–ª—Ç

> **ManyChat –±–æ–ª –∞–Ω—Ö–∞–Ω —à–∞—Ç–Ω—ã —Ö–∞—Ä–∏–ª—Ü–∞—Ö —Ö—ç—Ä—ç–≥—Å—ç–ª**
> **Web App –±–æ–ª –±–æ–¥–∏—Ç —Ç–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö, —Ö—è–Ω–∞—Ö —Ç”©–≤ —Å–∏—Å—Ç–µ–º**
> ‚Üí –¢–∞ —Ö—ç—Ä—ç–≥–ª—ç–≥—á–∏–π–≥ —á–∞—Ç–±–æ—Ç–æ–æ—Å `X —Ç–∞–π–ª–∞–Ω –∏–ª–≥—ç—ç—Ö`, `–¶—ç–Ω—ç–≥–ª—ç—Ö`, `–¢“Ø“Ø—Ö —Ö–∞—Ä–∞—Ö` “Ø–π–ª–¥—ç–ª —Ä“Ø“Ø —à–∏–ª–∂“Ø“Ø–ª—Å–Ω—ç—ç—Ä UX –±–æ–ª–æ–Ω —Å–∏—Å—Ç–µ–º–∏–π–Ω –±“Ø—Ç—ç—Ü –∞–ª—å –∞–ª—å —Ç–∞–ª–¥–∞–∞ –æ–Ω–æ–≤—á—Ç–æ–π —à–∏–π–¥—ç–≥–¥—ç–Ω—ç.

---